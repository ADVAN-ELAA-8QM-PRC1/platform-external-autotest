# Copyright (c) 2013 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

AUTHOR = 'wiley@chromium.org'
NAME = 'network_WiFiChaosPSK.local'
TIME = 'LONG'
TEST_CATEGORY = 'Functional'
TEST_CLASS = 'network'
TEST_TYPE = 'server'

DOC = """
This script iterates through user-specified access points in the AP
compatibility lab which supports PSK security and has a chrome device connect
to each in series. This test is intended to be run at your local site against
the APs listed in chaos_shadow_ap_list.conf.  Changes to this file are ignored
by git.
"""

from autotest_lib.server.cros.chaos_lib import chaos_interop_test


def run_chaos_psk(machine):
    # List of specific APs to debug. Please verify the APs indeed support PSK.
    # Add your APs here.
    debug_aps = []
    # IP or DNS name of host to use as a packet capturing device.
    capturer_hostname = None
    host = hosts.create_host(machine)
    helper = chaos_interop_test.WifiChaosTest('network_WiFiChaosPSK', host)
    helper.run(job, ap_spec={'hostnames': debug_aps},  batch_size=2, tries=2,
               capturer_hostname=capturer_hostname)


parallel_simple(run_chaos_psk, machines)

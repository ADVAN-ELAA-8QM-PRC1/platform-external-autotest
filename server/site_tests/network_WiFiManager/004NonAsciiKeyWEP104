# Copyright (c) 2012 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# Purpose: This test case verifies that the DUT can connect to an AP using
# WEP authentication with 104-bit pre-shared keys (Ascii and non-Ascii).

{ "name":"CheckAsciiWEPKey104",
  "steps":[             # Channel [1,6,11]
    [ "create",         { "type":"hostap" } ],
    [ "config",         { "channel":"2412", "mode":"11g",
                          "wepmode":"on",
                          # use quoted characters or unquoted hex digits
                          # hostapd supports up to 4 keys. D-Bus requires
                          # string parameters must be valid UTF-8
                          # key length = 13 bytes
                          "wep_key0":  '01020304050607080900010203',
                          # mix ASCII characters with a 3-byte UTF-8 characters
                          "wep_key1":  '"一二三四d"',
                          # mix different byte length UTF-8 characters
                          "wep_key2":  '"一二三\xc2\xa2\xc2\xa3"',
                        }
    ],

    # key index 0, 104-bit WEP
    [ "config",         { "deftxkey":"0" } ],
    [ "connect",        { "security":"wep",
                          "psk":'"0:"01020304050607080900010203' } ],
    [ "client_ping",    { "count":"10" } ],
    [ "disconnect" ],
    [ "deconfig" ],

    # key index 1, 104-bit WEP
    [ "config",         { "deftxkey":"1" } ],
    [ "connect",        { "security":"wep", "psk":"1:一二三四d" } ],
    [ "client_ping",    { "count":"10" } ],
    [ "disconnect" ],
    [ "deconfig" ],

    # key index 2, 104-bit WEP
    [ "config",         { "deftxkey":"2" } ],
    [ "connect",        { "security":"wep",
                          "psk":"2:一二三\xc2\xa2\xc2\xa3" } ],
    [ "client_ping",    { "count":"10" } ],
    [ "disconnect" ],

    [ "destroy" ],
  ],
}

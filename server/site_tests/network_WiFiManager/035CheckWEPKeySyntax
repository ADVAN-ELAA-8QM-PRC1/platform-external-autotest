# Copyright (c) 2010 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# Purpose: This test verifies that DUT cannot successfully connect to an AP
# when using invalid WEP key.

{ "name":"CheckWEPKeySyntax",
  "steps":[
    [ "create",         { "type":"hostap" } ],
    [ "config",         { "channel":"2412", "mode":"11g",
                          "wepmode":"on",
                          # 40-bit key (10 hex digits)
                          "wep_key0":  "0123456789",
                          # 104-bit key (26 hex digits)
                          "wep_key1":  "0123456789abcdef0123456789",
                        }
    ],

    # key index 0, too short for WEP-40
    [ "!connect",        { "security":"wep", "psk":"0:0" } ],
    [ "!connect",        { "security":"wep", "psk":"0:01" } ],
    [ "!connect",        { "security":"wep", "psk":"0:012" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0123" } ],
    [ "!connect",        { "security":"wep", "psk":"0:01234" } ],
    [ "!connect",        { "security":"wep", "psk":"0:012345" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0123456" } ],
    [ "!connect",        { "security":"wep", "psk":"0:01234567" } ],
    [ "!connect",        { "security":"wep", "psk":"0:012345678" } ],

    # key index 0, 0x prefix, too short for WEP-40
    [ "!connect",        { "security":"wep", "psk":"0:0x0" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x01" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x012" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x0123" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x01234" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x012345" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x0123456" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x01234567" } ],
    [ "!connect",        { "security":"wep", "psk":"0:0x012345678" } ],

    # key index 1, too short for WEP-104
    [ "!connect",        { "security":"wep", "psk":"1:0123456789a" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789ab" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789abc" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789abcd" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789abcde" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789abcdef" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789abcdef0" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789abcdef01" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0123456789abcdef012" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef01234" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef012345" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123456" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef01234567" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef012345678" } ],

    # key index 1, 0x prefix, too short for WEP-104
    [ "!connect",        { "security":"wep", "psk":"1:0x0123456789a" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0x0123456789ab" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0x0123456789abc" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0x0123456789abcd" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0x0123456789abcde" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0x0123456789abcdef" } ],
    [ "!connect",        { "security":"wep", "psk":"1:0x0123456789abcdef0" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef01" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef012" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef01234" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef012345" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123456" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef01234567" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef012345678" } ],

    # key index 1, too long for WEP-104
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123456789a" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123456789ab" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123456789abc" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123456789abcd" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123456789abcde" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0123456789abcdef0123456789abcdef" } ],

    # key index 1, 0x prefix, too long for WEP-104
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123456789a" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123456789ab" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123456789abc" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123456789abcd" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123456789abcde" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"1:0x0123456789abcdef0123456789abcdef" } ],

    # invalid key index, valid 40-bit WEP key
    [ "!connect",        { "security":"wep", "psk":"4:0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"-2:0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"a:0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"00:0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"gg:0123456789" } ],

    # invalid key index, 0x prefix, valid 40-bit WEP key
    [ "!connect",        { "security":"wep", "psk":"4:0x0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"-2:0x0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"a:0x0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"01:0x0123456789" } ],
    [ "!connect",        { "security":"wep", "psk":"gg:0x0123456789" } ],

    # invalid key index, valid 104-bit WEP key
    [ "!connect",        { "security":"wep",
                           "psk":"4:0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"01:0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"-2:0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"a:0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"gg:0123456789abcdef0123456789" } ],

    # invalid key index, 0x prefix, valid 104-bit WEP key
    [ "!connect",        { "security":"wep",
                           "psk":"4:0x0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"01:0x0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"-2:0x0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"a:0x0123456789abcdef0123456789" } ],
    [ "!connect",        { "security":"wep",
                           "psk":"gg:0x0123456789abcdef0123456789" } ],

    [ "destroy" ],
  ],
}

# Copyright (c) 2012 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# Purpose: This test case verifies that the DUT can connect to an AP using
# WEP authentication with 40-bit pre-shared keys (Ascii and non-Ascii).

{ "name":"CheckNonAsciiWEPKey40",
  "steps":[
    [ "create",         { "type":"hostap" } ],
    [ "config",         { "channel":"2412", "mode":"11g",
                          "wepmode":"on",
                          # use quoted characters or unquoted hex digits
                          # hostapd supports up to 4 keys. D-Bus requires
                          # string parameters must be valid UTF-8
                          # key length = 5 bytes
                          # mix ASCII characters with a 3-byte UTF-8 character
                          "wep_key0":  '"ab三"',
                          # mix different byte length UTF-8 characters
                          "wep_key1":  '"三\xc2\xa2"',
                        }
    ],

    # key index 0, 40-bit WEP
    [ "config",         { "deftxkey":"0" } ],
    [ "connect",        { "security":"wep", "psk":"0:ab三" } ],
    [ "client_ping",    { "count":"10" } ],
    [ "disconnect" ],
    [ "deconfig" ],

    # key index 1, 40-bit WEP
    [ "config",         { "deftxkey":"1" } ],
    [ "connect",        { "security":"wep", "psk":"1:三\xc2\xa2" } ],
    [ "client_ping",    { "count":"10" } ],
    [ "disconnect" ],

    [ "destroy" ],
  ],
}

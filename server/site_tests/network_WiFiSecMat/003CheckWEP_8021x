# Copyright (c) 2011 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# 802.1x authentication with dynamic WEP.

{ "name":"WEP_8021x",
  "steps":[             # Channel [any]
    [ "create",         { "type":"hostap" } ],
    [ "install_files",  { "system" : "router",
                          "files" :
                          { site_eap_certs.server_ca_cert_1_install_path :
                                  site_eap_certs.ca_cert_1,
                            site_eap_certs.server_cert_1_install_path :
                                  site_eap_certs.server_cert_1,
                            site_eap_certs.server_key_1_install_path :
                                  site_eap_certs.server_private_key_1,
                            "/tmp/hostapd_eap_user_file" :
                                  "* TLS"} } ],
    [ "config",         { "channel":"2412", "mode":"11g",
                          "wep_key_len_broadcast":"13",
                          "wep_key_len_unicast":"13",
                          "wep_rekey_period":"20",
                          "ieee8021x":"1",
                          "eap_server" : "1",
                          "ca_cert" :
                              site_eap_certs.server_ca_cert_1_install_path,
                          "server_cert" :
                              site_eap_certs.server_cert_1_install_path,
                          "private_key" :
                              site_eap_certs.server_key_1_install_path,
                          "eap_user_file" : "/tmp/hostapd_eap_user_file"} ],

    [ "install_files",  { "system" : "client",
                          "files" :
                        { site_eap_certs.client_ca_cert_1_install_path :
                                site_eap_certs.ca_cert_1,
                          site_eap_certs.client_cert_1_install_path :
                                site_eap_certs.client_cert_1,
                          site_eap_certs.client_key_1_install_path :
                                site_eap_certs.client_private_key_1 }, }, ],

    [ "connect",        { "security":"802_1x_wep",
                          "psk" : "EAP.KeyMgmt:IEEE8021X"
                          ":EAP.Identity:chromeos"
                          ":EAP.ClientCert:" +
                              site_eap_certs.client_cert_1_install_path +
                          ":EAP.PrivateKey:" +
                              site_eap_certs.client_key_1_install_path +
                          ":EAP.CACert:" +
                              site_eap_certs.client_ca_cert_1_install_path }, ],

    [ "client_ping",    { "count":"10" } ],

    [ "disconnect" ],

    [ "destroy" ],
  ],
}

# Copyright (c) 2010 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# This tests that the DUT can re-authenticate to a "strict auth" router
# after they lose synchronization on the DUT's authentication state.  A
# strict auth router will send a DEAUTH to a client it thinks is already
# authenticated, if the client sends another AUTH request.
{ "name":"StrictAuth",
  "steps":[             # Channel [1,6,11]
    [ "create",         { "type":"hostap" } ],
    [ "config",         { "channel":"2412", "mode":"11b", "strict_auth":"1" } ],
    [ "connect",        { "security":"none" } ],
    # Reboot the client.  This will cause the AP to still think the client
    # is authenticated, while the client loses record of this state.
    [ "client_reboot" ],
    # Try to connect again.  The strict-mode AP will DEAUTH initially, and
    # then accept the connection.
    [ "connect",        { "security":"none" } ],
    [ "destroy" ],
  ],
}

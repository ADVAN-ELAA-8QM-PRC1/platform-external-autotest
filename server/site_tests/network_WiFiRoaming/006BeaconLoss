# Copyright (c) 2010 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# This tests how fast the DUT responds to beacon loss when AP completely
# disappears
{ "name":"BeaconLoss",
  "steps":[
    [ "create",               { "type":"hostap" } ],
    [ "config",               { "channel":"2412", "mode":"11b" } ],
    [ "connect",              { "security":"none" } ],
    [ "client_ping",          { "count":"10" } ],
    [ "sleep",                { "time":"5" } ],
    [ "deconfig",             { "silent":None } ],  # Exit AP without DEAUTH
    [ "wait_service",         { "run_timeout":10,   # Timeout is 10 seconds
                                "debug":True,       # Print state transitions
                                "states":[
                                  (None, 'idle')    # Wait for transition to
                                ] } ],              # 'idle' state.

    # Do the test again, this time forcing a scan on the DUT just before the
    # AP disappears.
    [ "config",               { "channel":"2412", "mode":"11b" } ],
    [ "connect",              { "security":"none" } ],
    [ "client_ping",          { "count":"10" } ],
    [ "scan" ],
    [ "deconfig",             { "silent":None } ],  # Exit AP without DEAUTH
    [ "wait_service",         { "run_timeout":10,   # Timeout is 10 seconds
                                "debug":True,       # Print state transitions
                                "states":[
                                  (None, 'idle')    # Wait for transition to
                                ] } ],              # 'idle' state.
    [ "destroy" ],
  ],
}

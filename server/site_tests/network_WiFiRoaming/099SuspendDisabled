# Copyright (c) 2010 The Chromium OS Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# The ath9k driver had a bug where the the WiFi hardware would hang
# if we suspended and resumed twice while WiFi was disabled.  Run
# this test to make sure we never regress.  Try to run this late
# in the cycle so if this test fails, we don't take other tests with
# us.
{ "name":"SDisabled",
  "steps":[             # Channel 1,6,11
    [ "create",         { "type":"hostap" } ],

    # Connect the DUT to an AP
    [ "config",         { "channel":"2412", "mode":"11b",
                          "ssid_suffix": 't1'} ],
    # Turn WiFi off
    [ "disable_wifi" ],

    # Put the system to sleep for 3 seconds, twice
    [ "client_suspend", { "suspend_time": "3" } ],
    [ "client_suspend", { "suspend_time": "3" } ],

    # Turn WiFi back on
    [ "enable_wifi" ],

    [ "connect",        { "security":"none" } ],
    [ "client_ping",    { "count":"10" } ],

    [ "destroy" ],

  ],
}
